
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exploration and Preprocessing of VGP database &#8212; Polar Wandering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Polar Wandering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="book/intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/PolarWandering/Young_CEED.git/main/v2/gh/PolarWandering/Young_CEED/main?urlpath=tree/0_Preprocessing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/PolarWandering/Young_CEED/blob/main/Preprocessing.ipynb/github/PolarWandering/Young_CEED/blob/main/0_Preprocessing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/PolarWandering/Young_CEED"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/0_Preprocessing.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exploration and Preprocessing of VGP database
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-scientific-python-libraries">
     Import scientific Python libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gather-study-files">
     Gather study files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-study-inspection">
     Single study inspection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separate-the-xlsx-file-into-two-different-dfs-df-vgps-and-df-poles">
       Separate the *.xlsx file into two different DFs,
       <code class="docutils literal notranslate">
        <span class="pre">
         df_vgps
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         df_poles
        </span>
       </code>
       .
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-then-proceed-to-populate-the-vgp-dataframe-df-vgps-following-different-criteria">
     We then proceed to populate the VGP DataFrame (
     <code class="docutils literal notranslate">
      <span class="pre">
       df_vgps
      </span>
     </code>
     ) following different criteria
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-polarity-of-vgps-against-directions">
     Check polarity of VGPs against directions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#catch-some-exceptions">
       Catch some exceptions:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summarize-site-level-data">
       Summarize site level data
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterate-through-all-the-files-to-generate-summary-plots-and-catch-exceptions">
   Iterate through all the files to generate summary plots and catch exceptions:
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Exploration and Preprocessing of VGP database</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exploration and Preprocessing of VGP database
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-scientific-python-libraries">
     Import scientific Python libraries
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gather-study-files">
     Gather study files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#single-study-inspection">
     Single study inspection
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#separate-the-xlsx-file-into-two-different-dfs-df-vgps-and-df-poles">
       Separate the *.xlsx file into two different DFs,
       <code class="docutils literal notranslate">
        <span class="pre">
         df_vgps
        </span>
       </code>
       and
       <code class="docutils literal notranslate">
        <span class="pre">
         df_poles
        </span>
       </code>
       .
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-then-proceed-to-populate-the-vgp-dataframe-df-vgps-following-different-criteria">
     We then proceed to populate the VGP DataFrame (
     <code class="docutils literal notranslate">
      <span class="pre">
       df_vgps
      </span>
     </code>
     ) following different criteria
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-polarity-of-vgps-against-directions">
     Check polarity of VGPs against directions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#catch-some-exceptions">
       Catch some exceptions:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summarize-site-level-data">
       Summarize site level data
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iterate-through-all-the-files-to-generate-summary-plots-and-catch-exceptions">
   Iterate through all the files to generate summary plots and catch exceptions:
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="exploration-and-preprocessing-of-vgp-database">
<h1>Exploration and Preprocessing of VGP database<a class="headerlink" href="#exploration-and-preprocessing-of-vgp-database" title="Permalink to this headline">#</a></h1>
<p>This notebook preprocesses site level data from the VGP database compilation, checks for missing data, compares reported and calculated pole positions, conducts associated statistical tests, and makes visualizations of data at the study level.</p>
<section id="import-scientific-python-libraries">
<h2>Import scientific Python libraries<a class="headerlink" href="#import-scientific-python-libraries" title="Permalink to this headline">#</a></h2>
<p>Import scipy python libraries as well as functions written for the project within vgptools.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">ipmag</span><span class="p">,</span> <span class="n">pmag</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">vgptools.auxiliar</span> <span class="kn">import</span> <span class="p">(</span><span class="n">get_files_in_directory</span><span class="p">,</span> <span class="n">spherical2cartesian</span><span class="p">,</span> 
                               <span class="n">cartesian2spherical</span><span class="p">,</span> <span class="n">GCD_cartesian</span><span class="p">,</span> 
                               <span class="n">print_pole_statistics</span><span class="p">,</span> <span class="n">test_fishqq</span><span class="p">,</span> 
                               <span class="n">statistical_tests</span><span class="p">,</span> <span class="n">summary_figure</span><span class="p">,</span>
                               <span class="n">invert_polarity</span><span class="p">,</span> <span class="n">Plot_VgpsAndSites</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_colwidth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="gather-study-files">
<h2>Gather study files<a class="headerlink" href="#gather-study-files" title="Permalink to this headline">#</a></h2>
<p>We retrieve all the spreadsheet files corresponding to different studies for which site level data are compiled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">data_path_VGP</span> <span class="o">=</span> <span class="n">current_path</span> <span class="o">+</span> <span class="s1">&#39;/data/vgp_database&#39;</span>
<span class="n">files_names</span> <span class="o">=</span> <span class="n">get_files_in_directory</span><span class="p">(</span><span class="n">data_path_VGP</span><span class="p">)</span>

<span class="n">xlsx_file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files_names</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)]</span> 
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files_names</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)]</span> 
<span class="n">df_files</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">paths</span><span class="p">,</span>  <span class="s1">&#39;name_xlsx&#39;</span><span class="p">:</span> <span class="n">xlsx_file_names</span><span class="p">})</span>
<span class="n">df_files</span><span class="p">[[</span><span class="s1">&#39;name_xlsx&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name_xlsx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tequila_volcanic_field</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Coso_Range_volcanics</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eastern_Alkaline_Province</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SW_USA_composite</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N_Montana_intrusions</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Long_Valley_Caldera_volcanics</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Robinson_Antincline_intrusions</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Central_Mexico_Plio-Pleistocene</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Rattlesnake_Hills_volcanics</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ramsay_Island_lavas</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Sierra_de_Las_Cruces</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Snake_River_Plain</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Sonoma_volcanics</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mistastin_Lake_impact</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Bighorn_Basin_sediments</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Absaroka_volcanics</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Eastern_TMVB</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Bishop_tuff</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Western_Central_TMVB</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Dinan_Bay_lavas</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Valles_Caldera_volcanics</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Bitterroot_Dome_intrusions</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Stoddard_Mountain_laccolith</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Michoacan_Guanajuato_volcanic_field</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Clear_Lake_volcanic_field</td>
    </tr>
    <tr>
      <th>25</th>
      <td>San_Luis_Hills_volcanics</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Beaver_River_intrusions</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Mariscal_Mtn_intrusions</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mogollon-Datil_volcanics</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Monterey_intrusions</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Latir_volcanic_field</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="single-study-inspection">
<h2>Single study inspection<a class="headerlink" href="#single-study-inspection" title="Permalink to this headline">#</a></h2>
<p>In order to understand what is going on in one single site, we can conduct statistical tests and visualize the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_idx</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<section id="separate-the-xlsx-file-into-two-different-dfs-df-vgps-and-df-poles">
<h3>Separate the *.xlsx file into two different DFs, <code class="docutils literal notranslate"><span class="pre">df_vgps</span></code> and <code class="docutils literal notranslate"><span class="pre">df_poles</span></code>.<a class="headerlink" href="#separate-the-xlsx-file-into-two-different-dfs-df-vgps-and-df-poles" title="Permalink to this headline">#</a></h3>
<p><em>Note: the the number of lines to be skipped is hardcoded.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">split_datasheet</span><span class="p">(</span><span class="n">df_files</span><span class="p">,</span> <span class="n">file_idx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads in datasheets and splits them into pole and vgp collections to be filtered, collated and compiled.</span>
<span class="sd">    Input: standard vgp datasheet (as described in datasheet template)</span>
<span class="sd">    Output: separate dataframes comprised of the study-level poles and site-level vgps extracted from the datasheet</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">df_files</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">][</span><span class="n">file_idx</span><span class="p">])</span> <span class="c1">#, skip_blank_lines=True</span>
    <span class="n">df_poles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">df_files</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">][</span><span class="n">file_idx</span><span class="p">],</span> 
                             <span class="n">skiprows</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Study level data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">nrows</span>  <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">df_files</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">][</span><span class="n">file_idx</span><span class="p">],</span> 
                            <span class="n">skiprows</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Site level data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1">#cast columns</span>
    <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;in_study_pole&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                              <span class="s2">&quot;slat&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;slon&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;dec&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;inc&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                              <span class="s2">&quot;VGP_lat&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;VGP_lon&quot;</span><span class="p">:</span><span class="nb">float</span>
                             <span class="p">})</span>
    <span class="n">df_poles</span> <span class="o">=</span> <span class="n">df_poles</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                              <span class="s2">&quot;slat&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;slon&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;dec&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;inc&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span>
                              <span class="s2">&quot;Plat&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;Plon&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">})</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">df_poles</span><span class="p">,</span> <span class="n">df_vgps</span><span class="p">)</span>

<span class="n">df_poles</span><span class="p">,</span> <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">split_datasheet</span><span class="p">(</span><span class="n">df_files</span><span class="p">,</span> <span class="n">file_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="we-then-proceed-to-populate-the-vgp-dataframe-df-vgps-following-different-criteria">
<h2>We then proceed to populate the VGP DataFrame (<code class="docutils literal notranslate"><span class="pre">df_vgps</span></code>) following different criteria<a class="headerlink" href="#we-then-proceed-to-populate-the-vgp-dataframe-df-vgps-following-different-criteria" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>In a previous step, we have calculated the site coordinates of all studies in which these coordinates were not reported, but the Dec/Inc and Plat/Plon were.</p></li>
<li><p>We recalculate the VGP longitudes and latitudes based on the site mean declination/inclination and site location longitude/latitude.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#First we calculate for the entire dataframe the vgps if there is dec/inc and slat/slon values</span>
<span class="k">def</span> <span class="nf">recalc_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">):</span>
    <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lon_recalc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dia_vgp</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">inc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">slat</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">slon</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lat_recalc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dia_vgp</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">inc</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">slat</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">slon</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_vgps</span>

<span class="n">df_vgps</span> <span class="o">=</span> <span class="n">recalc_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-polarity-of-vgps-against-directions">
<h2>Check polarity of VGPs against directions<a class="headerlink" href="#check-polarity-of-vgps-against-directions" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>Some sites report the backward VGP (so that the VGPs are in the same hemisphere/closer to the principal component). We proceed to check polarity of VGPs against directions. To do that, we recalculate the vgps from the original Dec/Inc.</p></li>
<li><p>Check distance (<code class="docutils literal notranslate"><span class="pre">df_vgps['GCD_vgps']</span></code>) between the reported VGPs and the recalculated from the directions.</p></li>
</ol>
<p>In this step we fill the column <code class="docutils literal notranslate"><span class="pre">df_vgps['coherent_vgps']</span></code> with the following tags:</p>
<ul class="simple">
<li><p>‘spurious’ if inconsistent combination of site coordinates + dec/inc + vgp data (+- 4 degrees away from the reported or its backward)</p></li>
<li><p>‘coherent’ if correct</p></li>
<li><p>‘inverted’ if inverted</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_coherence_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">):</span>

    <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;GCD_vgps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">GCD_cartesian</span><span class="p">(</span><span class="n">spherical2cartesian</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">VGP_lat</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">VGP_lon</span><span class="p">)]),</span> <span class="n">spherical2cartesian</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">VGP_lat_recalc</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">VGP_lon_recalc</span><span class="p">)])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># False if Spurious, True if correct, nan if inverted</span>
    <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="s1">&#39;spurious&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">GCD_vgps</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="n">row</span><span class="o">.</span><span class="n">GCD_vgps</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">176</span><span class="p">))</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;coherent&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">GCD_vgps</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;inverted&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">GCD_vgps</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">176</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="p">),</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#True if it is ok, nan</span>
    
    <span class="k">return</span> <span class="n">df_vgps</span>
<span class="n">df_vgps</span> <span class="o">=</span> <span class="n">check_coherence_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="catch-some-exceptions">
<h3>Catch some exceptions:<a class="headerlink" href="#catch-some-exceptions" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Missing slat/slon and/or dec/in where no vgp is reported</p></li>
<li><p>Missing dec/inc and/or vgp where no site coordinates are reported; cannot calculate site locations.</p></li>
<li><p>Inconsistent combination of site coordinates + dec/inc + vgp</p></li>
<li><p>Recalculated VGP was inverted.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">verbose</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Missing slat/slon from sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Missing dec/inc from sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Missing reported VGPs from sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span> <span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>    
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Missing slat/slon and/or dec/inc from sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[(</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;slat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2"> where no vgp is reported; cannot calculate vgp&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;spurious&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Inconsistent combination of site coordinates + dec/inc + vgp data from site(s) </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;spurious&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inverted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; inverted vgp from sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inverted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;coherent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Coherent dec/inc in sites (&#39;name&#39;): </span><span class="si">{</span><span class="n">df_vgps</span><span class="p">[</span><span class="n">df_vgps</span><span class="p">[</span><span class="s1">&#39;coherent_vgps&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;coherent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
<span class="n">verbose</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;BP10*&#39;, &#39;BP24*&#39;, &#39;BP43*&#39;, &#39;BP16*&#39;, &#39;BP26*&#39;, &#39;BP29*&#39;, &#39;HW6*&#39;, &#39;HW14*&#39;, &#39;HW15*&#39;, &#39;HW35*&#39;, &#39;HW37*&#39;, &#39;EB8*&#39;, &#39;SH5*&#39;, &#39;SH8*&#39;, &#39;SH9*&#39;, &#39;MB-2&#39;, &#39;MB-3&#39;, &#39;MB-4&#39;, &#39;MB-8*&#39;, &#39;MB-9&#39;, &#39;LB9*&#39;]

 =&gt; inverted vgp from sites (&#39;name&#39;): [&#39;BP4R&#39;, &#39;BP13&#39;, &#39;BP14&#39;, &#39;BP36&#39;, &#39;BP37&#39;, &#39;BP38&#39;, &#39;BP41&#39;, &#39;BP42&#39;, &#39;BP46&#39;, &#39;BP1&#39;, &#39;BP2&#39;, &#39;BP18&#39;, &#39;BP19*&#39;, &#39;BP20&#39;, &#39;BP21&#39;, &#39;BP27*&#39;, &#39;BP28*&#39;, &#39;BP31*&#39;, &#39;BP32&#39;, &#39;BP33&#39;, &#39;BP35*&#39;, &#39;SH1&#39;, &#39;SH2-4&#39;, &#39;SH3&#39;, &#39;SH6&#39;, &#39;SH7&#39;, &#39;SH10&#39;, &#39;SH12&#39;, &#39;SH13&#39;, &#39;SH14&#39;, &#39;MB-5*&#39;, &#39;MB-10&#39;, &#39;LB1&#39;, &#39;LB2&#39;, &#39;LB5&#39;, &#39;LB7*&#39;, &#39;LB8&#39;, &#39;LB10&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;BP4N&#39;, &#39;BP6&#39;, &#39;BP7&#39;, &#39;BP9&#39;, &#39;BP12&#39;, &#39;BP23&#39;, &#39;BP34&#39;, &#39;BP39*&#39;, &#39;BP40*&#39;, &#39;BP44&#39;, &#39;BP45&#39;, &#39;BP3&#39;, &#39;BPS&#39;, &#39;BP8*&#39;, &#39;BP15&#39;, &#39;BP17&#39;, &#39;BP11&#39;, &#39;BP25*&#39;, &#39;BP30&#39;, &#39;HW1&#39;, &#39;HW2&#39;, &#39;HW5*&#39;, &#39;HW7&#39;, &#39;HW8&#39;, &#39;HW9&#39;, &#39;HW10&#39;, &#39;HW11&#39;, &#39;HW12&#39;, &#39;HW13&#39;, &#39;HW16&#39;, &#39;HW17&#39;, &#39;HW18&#39;, &#39;HW19&#39;, &#39;HW20*&#39;, &#39;HW21&#39;, &#39;HW22&#39;, &#39;HW23&#39;, &#39;HW24-25-42&#39;, &#39;HW26-27&#39;, &#39;HW28&#39;, &#39;HW29&#39;, &#39;HW30&#39;, &#39;HW31&#39;, &#39;HW32&#39;, &#39;HW33&#39;, &#39;HW34&#39;, &#39;HW36&#39;, &#39;HW38&#39;, &#39;HW39&#39;, &#39;HW40&#39;, &#39;HW41&#39;, &#39;EB1&#39;, &#39;EB2&#39;, &#39;EB3&#39;, &#39;EB4&#39;, &#39;EB5&#39;, &#39;EB6&#39;, &#39;EB7&#39;, &#39;SH11&#39;, &#39;MB-1&#39;, &#39;MB-6*&#39;, &#39;MB-7&#39;, &#39;LB3&#39;, &#39;LB6**&#39;, &#39;LB11&#39;, &#39;LB12&#39;, &#39;LB13&#39;, &#39;LB14&#39;, &#39;LB15*&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="summarize-site-level-data">
<h3>Summarize site level data<a class="headerlink" href="#summarize-site-level-data" title="Permalink to this headline">#</a></h3>
<p>For each reported pole from the selected manuscript, we iterate through the constituent site-level data and:</p>
<ol class="simple">
<li><p>cast all vgps into a common polarity and re-compute the Fisher mean paleomagnetic pole</p></li>
<li><p>plot the site locations, vgps, and the results of reversal and Fisher distribution tests</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">studies</span><span class="p">,</span> <span class="n">pps</span><span class="p">,</span> <span class="n">misfit</span><span class="p">,</span> <span class="n">misfit_type</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">process_study</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">,</span><span class="n">file_idx</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">pole</span><span class="p">,</span> <span class="n">df_pole</span> <span class="ow">in</span> <span class="n">df_vgps</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;in_study_pole&#39;</span><span class="p">):</span>
        
        <span class="n">df_pole</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;testdf.csv&#39;</span><span class="p">)</span>
        <span class="c1"># value represent the index and i represent the DF grouped by the variable of interest  </span>
        <span class="k">if</span> <span class="n">pole</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#does not consider vgps discarded by authors</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;==&gt;Analyzing pole </span><span class="si">{</span><span class="n">pole</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="n">directions_block</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">make_di_block</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> 
                                                   <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                                                   <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">di_mode1</span><span class="p">,</span> <span class="n">di_mode2</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">directions_block</span><span class="p">)</span>

            <span class="n">vgp_recalc_block</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">make_di_block</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon_recalc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> 
                                                   <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat_recalc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                                                   <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1">#split recalculated vgp population into polarities             </span>
            <span class="n">vgp_mode1</span><span class="p">,</span> <span class="n">vgp_mode2</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">vgp_recalc_block</span><span class="p">)</span>
            <span class="n">merged_vgps</span> <span class="o">=</span> <span class="n">invert_polarity</span><span class="p">(</span><span class="n">vgp_mode1</span><span class="p">,</span> <span class="n">vgp_mode2</span><span class="p">)</span>
            <span class="n">vgp_mean_recomputed</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">(</span><span class="n">di_block</span> <span class="o">=</span> <span class="n">merged_vgps</span><span class="p">)</span>

            <span class="c1"># calculate the Fisher mean of reported VGPs</span>
            <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat_recalc&#39;</span><span class="p">],</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">])</span>
            <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon_recalc&#39;</span><span class="p">],</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">])</span>
            <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;vgp_lat_NH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">],</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">])</span>
            <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;vgp_lon_NH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lat&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,(</span><span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span><span class="p">,</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;VGP_lon&#39;</span><span class="p">])</span>             
            <span class="n">vgp_mean</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">(</span><span class="n">dec</span> <span class="o">=</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;vgp_lon_NH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">df_pole</span><span class="p">[</span><span class="s1">&#39;vgp_lat_NH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

            <span class="c1">#reported pole</span>
            <span class="n">reported_pole</span> <span class="o">=</span> <span class="n">df_poles</span><span class="p">[</span><span class="n">df_poles</span><span class="p">[</span><span class="s1">&#39;pole&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pole</span><span class="p">]</span>

            <span class="n">study_number</span> <span class="o">=</span> <span class="n">file_idx</span>
            <span class="n">study_folder</span> <span class="o">=</span> <span class="s1">&#39;./study_summaries&#39;</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">study_number</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">study_folder</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">study_folder</span><span class="p">)</span>

            <span class="n">pole_number</span> <span class="o">=</span> <span class="n">pole</span>
            <span class="n">pole_folder</span> <span class="o">=</span> <span class="n">study_folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pole_number</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pole_folder</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">pole_folder</span><span class="p">)</span>

            <span class="n">pole_summary</span> <span class="o">=</span> <span class="n">print_pole_statistics</span><span class="p">(</span><span class="n">reported_pole</span><span class="p">,</span> 
                                                 <span class="n">vgp_mean</span><span class="p">,</span> 
                                                 <span class="n">vgp_mean_recomputed</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pole_folder</span> <span class="o">+</span> <span class="s1">&#39;/pole_summary.tex&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pole_summary</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>

            <span class="n">stat_test_results</span> <span class="o">=</span> <span class="n">statistical_tests</span><span class="p">(</span><span class="n">di_mode1</span><span class="p">,</span> <span class="n">di_mode2</span><span class="p">,</span> <span class="n">merged_vgps</span><span class="p">,</span> 
                                                  <span class="n">study_number</span><span class="o">=</span><span class="n">file_idx</span><span class="p">,</span> 
                                                  <span class="n">pole_number</span><span class="o">=</span><span class="n">pole</span><span class="p">,</span> 
                                                  <span class="n">save_folder</span><span class="o">=</span><span class="n">pole_folder</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pole_folder</span> <span class="o">+</span> <span class="s1">&#39;/stat_test.tex&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stat_test_results</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>

            <span class="n">summary_figure</span><span class="p">(</span><span class="n">df_pole</span><span class="p">,</span> <span class="n">vgp_mode1</span><span class="p">,</span> <span class="n">vgp_mode2</span><span class="p">,</span> 
                           <span class="n">reported_pole</span><span class="p">,</span> <span class="n">vgp_mean</span><span class="p">,</span> <span class="n">pole_folder</span><span class="p">)</span>

            <span class="n">study_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">])</span>
            <span class="n">study_name</span> <span class="o">=</span> <span class="n">study_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">pole_local_folder</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">study_number</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pole_number</span><span class="p">)</span>
            <span class="n">tex_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./study_summaries/SI_study_summary.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pole_number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\section{&#39;</span> <span class="o">+</span> <span class="n">study_name</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span>
                <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\subsection{Pole &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pole_number</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\subsection{Pole &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\input{&#39;</span> <span class="o">+</span> <span class="n">pole_local_folder</span> <span class="o">+</span> <span class="s1">&#39;/pole_summary.tex&#39;</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\input{&#39;</span> <span class="o">+</span> <span class="n">pole_local_folder</span> <span class="o">+</span> <span class="s1">&#39;/stat_test.tex&#39;</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">begin</span><span class="si">{figure}</span><span class="s1">[H]&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\centering&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\includegraphics[width=5 in]{&#39;</span> <span class="o">+</span> <span class="n">pole_local_folder</span> <span class="o">+</span> <span class="s1">&#39;/pole_summary.png}&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\caption{Summary of data from locality &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_idx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">study_name</span> <span class="o">+</span> <span class="s1">&#39;) pole &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">reported_pole</span><span class="p">[</span><span class="s1">&#39;pmag_ref&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;).}&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;\end</span><span class="si">{figure}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tex_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            
            <span class="k">try</span><span class="p">:</span>
               <span class="n">vgp_mean</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
               <span class="n">vgp_mean</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">vgp_mean</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">studies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">])</span>
                <span class="n">pps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span>
                <span class="n">misfit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">([</span><span class="n">vgp_mean</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">vgp_mean</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]],</span> 
                                       <span class="p">[</span><span class="n">reported_pole</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Plon&#39;</span><span class="p">],</span> <span class="n">reported_pole</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Plat&#39;</span><span class="p">]])[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">misfit_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;reported&#39;</span><span class="p">)</span>

                <span class="n">studies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">])</span>
                <span class="n">pps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span>                
                <span class="n">misfit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">([</span><span class="n">vgp_mean_recomputed</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">vgp_mean_recomputed</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]],</span> 
                                       <span class="p">[</span><span class="n">reported_pole</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Plon&#39;</span><span class="p">],</span> <span class="n">reported_pole</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Plat&#39;</span><span class="p">]])[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">misfit_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;recalculated&#39;</span><span class="p">)</span>
                
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            
<span class="n">process_study</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">,</span><span class="n">file_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 1 (N_Montana_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>94</td>
      <td>82.0</td>
      <td>170.2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>95</td>
      <td>82.4</td>
      <td>178.4</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>95</td>
      <td>82.3</td>
      <td>178.5</td>
      <td>3.6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_17_3.png" src="_images/0_Preprocessing_17_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           6.2
Critical value of V:  6.2
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 5.4
Critical angle for M&amp;M1990:   5.4
The McFadden and McElhinny (1990) classification for
this test is: &#39;B&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_17_5.png" src="_images/0_Preprocessing_17_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 5.4º below 5.4º critical angle); B classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_17_9.png" src="_images/0_Preprocessing_17_9.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iterate-through-all-the-files-to-generate-summary-plots-and-catch-exceptions">
<h1>Iterate through all the files to generate summary plots and catch exceptions:<a class="headerlink" href="#iterate-through-all-the-files-to-generate-summary-plots-and-catch-exceptions" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">studies</span><span class="p">,</span> <span class="n">pps</span><span class="p">,</span> <span class="n">misfit</span><span class="p">,</span> <span class="n">misfit_type</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">file_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_files</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;========================= NEW POLE : </span><span class="si">{</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">]</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">file_idx</span><span class="si">}</span><span class="s1">) =======================&#39;</span><span class="p">)</span>
    
    <span class="n">df_poles</span><span class="p">,</span> <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">split_datasheet</span><span class="p">(</span><span class="n">df_files</span><span class="p">,</span> <span class="n">file_idx</span><span class="p">)</span>
    <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">recalc_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
    <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">check_coherence_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
    <span class="n">verbose</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>
    <span class="n">process_study</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">,</span><span class="n">file_idx</span><span class="p">)</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Tequila_volcanic_field (0) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;TL1&#39;, &#39;TL5&#39;, &#39;TM3&#39;, &#39;TM2&#39;, &#39;TM1&#39;, &#39;TM6&#39;, &#39;TM11&#39;, &#39;TM10&#39;, &#39;TM9&#39;, &#39;TL2&#39;, &#39;TL9&#39;, &#39;TM5&#39;, &#39;TM8&#39;, &#39;TL3&#39;, &#39;TL12&#39;, &#39;TL4&#39;, &#39;TL10&#39;, &#39;TL7&#39;, &#39;TL11&#39;, &#39;TM4&#39;, &#39;TM7&#39;]

==&gt;Analyzing pole 1 (Tequila_volcanic_field).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>17</td>
      <td>85.8</td>
      <td>84.3</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>17</td>
      <td>85.8</td>
      <td>84.4</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>17</td>
      <td>85.4</td>
      <td>83.9</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_3.png" src="_images/0_Preprocessing_19_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           4.3
Critical value of V:  11.2
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 18.8
Critical angle for M&amp;M1990:   30.6
The McFadden and McElhinny (1990) classification for
this test is: &#39;INDETERMINATE;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Ambiguous: weak support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_5.png" src="_images/0_Preprocessing_19_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 18.8º below 30.6º critical angle); indeterminate classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Ambiguous: weak support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_9.png" src="_images/0_Preprocessing_19_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Coso_Range_volcanics (1) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [58.0, 35.0, 32.0, 33.0]

==&gt;Analyzing pole 1 (Coso_Range_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>2</td>
      <td>73.8</td>
      <td>69.3</td>
      <td>66.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>2</td>
      <td>73.8</td>
      <td>69.3</td>
      <td>66.8</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_15.png" src="_images/0_Preprocessing_19_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Eastern_Alkaline_Province (2) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;VE17&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;VE18&#39;, &#39;VE19&#39;, &#39;VE10&#39;, &#39;VE13&#39;, &#39;VE12&#39;, &#39;VE09&#39;, &#39;VE11&#39;, &#39;VE14&#39;, &#39;VE16&#39;, &#39;VE05&#39;, &#39;VE03&#39;, &#39;VE02&#39;, &#39;VE04&#39;, &#39;VE07&#39;, &#39;VE01&#39;, &#39;VE06&#39;, &#39;VE15&#39;, &#39;VE08&#39;]

==&gt;Analyzing pole 1 (Eastern_Alkaline_Province).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>17</td>
      <td>88.3</td>
      <td>93.4</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>17</td>
      <td>88.3</td>
      <td>87.7</td>
      <td>5.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_19.png" src="_images/0_Preprocessing_19_19.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           1.3
Critical value of V:  6.7
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 6.0
Critical angle for M&amp;M1990:   13.7
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_21.png" src="_images/0_Preprocessing_19_21.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 6.0º below 13.7º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_25.png" src="_images/0_Preprocessing_19_25.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : SW_USA_composite (3) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;1C138*&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;1C614&#39;, &#39;1C651&#39;, &#39;1C671&#39;, &#39;1C684&#39;, &#39;1C701&#39;, &#39;2C551&#39;, &#39;2C801*&#39;, &#39;2C804&#39;, &#39;3V021&#39;, &#39;3V028&#39;, &#39;3V038&#39;, &#39;3V048&#39;, &#39;3V061&#39;, &#39;3V077&#39;, &#39;1C118&#39;, &#39;2C809&#39;, &#39;2C821&#39;, &#39;2D005&#39;, &#39;2D041*&#39;, &#39;2D045&#39;, &#39;2D051*&#39;, &#39;2D056*&#39;, &#39;2D066*&#39;, &#39;2D072&#39;, &#39;3D101&#39;, &#39;3D115&#39;, &#39;3D131&#39;, &#39;3D138&#39;, &#39;3V069&#39;, &#39;3X209&#39;, &#39;3X245&#39;, &#39;3X901*&#39;, &#39;3X906&#39;, &#39;3X914&#39;, &#39;3X921&#39;, &#39;4D122&#39;, &#39;1C601&#39;, &#39;2C516*&#39;, &#39;2C576&#39;, &#39;2C582&#39;, &#39;2C591&#39;, &#39;2D001*&#39;, &#39;3D107&#39;, &#39;3V101&#39;, &#39;3V121&#39;, &#39;3V148&#39;, &#39;3X020&#39;, &#39;3X031&#39;, &#39;3X038&#39;, &#39;4D082&#39;, &#39;4D090&#39;, &#39;4D183&#39;, &#39;4D191&#39;, &#39;9E224&#39;, &#39;3V001&#39;, &#39;3V012*&#39;, &#39;3V085&#39;, &#39;3V093&#39;, &#39;3V109&#39;, &#39;3V167&#39;, &#39;3X001&#39;, &#39;3X013&#39;, &#39;4D174&#39;, &#39;5G102*&#39;, &#39;5G113*&#39;, &#39;5G122*&#39;, &#39;5G133&#39;, &#39;1C143*&#39;, &#39;1C151&#39;, &#39;1C160*&#39;, &#39;2C508*&#39;, &#39;2D010*&#39;, &#39;2D018*&#39;, &#39;2D025*&#39;, &#39;2D031*&#39;, &#39;2D036*&#39;, &#39;3V129*&#39;, &#39;3V138*&#39;, &#39;3V156&#39;, &#39;3V176&#39;, &#39;3X216&#39;, &#39;3X252*&#39;, &#39;3X259&#39;, &#39;4D098&#39;, &#39;4D106&#39;, &#39;4D114&#39;, &#39;4D130&#39;, &#39;4D140&#39;, &#39;4D148&#39;, &#39;4D155&#39;, &#39;4D165&#39;, &#39;4D218&#39;, &#39;4D227&#39;]

==&gt;Analyzing pole 1 (SW_USA_composite).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>70</td>
      <td>87.4</td>
      <td>162.9</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>70</td>
      <td>87.4</td>
      <td>162.9</td>
      <td>3.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>70</td>
      <td>87.4</td>
      <td>163.0</td>
      <td>3.9</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_29.png" src="_images/0_Preprocessing_19_29.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           9.6
Critical value of V:  6.2
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 7.9
Critical angle for M&amp;M1990:   6.4


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Ambiguous: weak support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_31.png" src="_images/0_Preprocessing_19_31.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 7.9º above 6.4º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Ambiguous: weak support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_35.png" src="_images/0_Preprocessing_19_35.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : N_Montana_intrusions (4) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;BP10*&#39;, &#39;BP24*&#39;, &#39;BP43*&#39;, &#39;BP16*&#39;, &#39;BP26*&#39;, &#39;BP29*&#39;, &#39;HW6*&#39;, &#39;HW14*&#39;, &#39;HW15*&#39;, &#39;HW35*&#39;, &#39;HW37*&#39;, &#39;EB8*&#39;, &#39;SH5*&#39;, &#39;SH8*&#39;, &#39;SH9*&#39;, &#39;MB-2&#39;, &#39;MB-3&#39;, &#39;MB-4&#39;, &#39;MB-8*&#39;, &#39;MB-9&#39;, &#39;LB9*&#39;]

 =&gt; inverted vgp from sites (&#39;name&#39;): [&#39;BP4R&#39;, &#39;BP13&#39;, &#39;BP14&#39;, &#39;BP36&#39;, &#39;BP37&#39;, &#39;BP38&#39;, &#39;BP41&#39;, &#39;BP42&#39;, &#39;BP46&#39;, &#39;BP1&#39;, &#39;BP2&#39;, &#39;BP18&#39;, &#39;BP19*&#39;, &#39;BP20&#39;, &#39;BP21&#39;, &#39;BP27*&#39;, &#39;BP28*&#39;, &#39;BP31*&#39;, &#39;BP32&#39;, &#39;BP33&#39;, &#39;BP35*&#39;, &#39;SH1&#39;, &#39;SH2-4&#39;, &#39;SH3&#39;, &#39;SH6&#39;, &#39;SH7&#39;, &#39;SH10&#39;, &#39;SH12&#39;, &#39;SH13&#39;, &#39;SH14&#39;, &#39;MB-5*&#39;, &#39;MB-10&#39;, &#39;LB1&#39;, &#39;LB2&#39;, &#39;LB5&#39;, &#39;LB7*&#39;, &#39;LB8&#39;, &#39;LB10&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;BP4N&#39;, &#39;BP6&#39;, &#39;BP7&#39;, &#39;BP9&#39;, &#39;BP12&#39;, &#39;BP23&#39;, &#39;BP34&#39;, &#39;BP39*&#39;, &#39;BP40*&#39;, &#39;BP44&#39;, &#39;BP45&#39;, &#39;BP3&#39;, &#39;BPS&#39;, &#39;BP8*&#39;, &#39;BP15&#39;, &#39;BP17&#39;, &#39;BP11&#39;, &#39;BP25*&#39;, &#39;BP30&#39;, &#39;HW1&#39;, &#39;HW2&#39;, &#39;HW5*&#39;, &#39;HW7&#39;, &#39;HW8&#39;, &#39;HW9&#39;, &#39;HW10&#39;, &#39;HW11&#39;, &#39;HW12&#39;, &#39;HW13&#39;, &#39;HW16&#39;, &#39;HW17&#39;, &#39;HW18&#39;, &#39;HW19&#39;, &#39;HW20*&#39;, &#39;HW21&#39;, &#39;HW22&#39;, &#39;HW23&#39;, &#39;HW24-25-42&#39;, &#39;HW26-27&#39;, &#39;HW28&#39;, &#39;HW29&#39;, &#39;HW30&#39;, &#39;HW31&#39;, &#39;HW32&#39;, &#39;HW33&#39;, &#39;HW34&#39;, &#39;HW36&#39;, &#39;HW38&#39;, &#39;HW39&#39;, &#39;HW40&#39;, &#39;HW41&#39;, &#39;EB1&#39;, &#39;EB2&#39;, &#39;EB3&#39;, &#39;EB4&#39;, &#39;EB5&#39;, &#39;EB6&#39;, &#39;EB7&#39;, &#39;SH11&#39;, &#39;MB-1&#39;, &#39;MB-6*&#39;, &#39;MB-7&#39;, &#39;LB3&#39;, &#39;LB6**&#39;, &#39;LB11&#39;, &#39;LB12&#39;, &#39;LB13&#39;, &#39;LB14&#39;, &#39;LB15*&#39;]

==&gt;Analyzing pole 1 (N_Montana_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>94</td>
      <td>82.0</td>
      <td>170.2</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>95</td>
      <td>82.4</td>
      <td>178.4</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>95</td>
      <td>82.3</td>
      <td>178.5</td>
      <td>3.6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_39.png" src="_images/0_Preprocessing_19_39.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           6.2
Critical value of V:  5.8
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 5.4
Critical angle for M&amp;M1990:   5.2


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_41.png" src="_images/0_Preprocessing_19_41.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 5.4º above 5.2º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_45.png" src="_images/0_Preprocessing_19_45.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Long_Valley_Caldera_volcanics (5) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;5L326&#39;, &#39;5L258&#39;, &#39;5L266&#39;, &#39;5L274&#39;, &#39;5L417&#39;, &#39;5L241&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;5L209&#39;, &#39;5L233&#39;, &#39;5L352&#39;, &#39;5L452&#39;, &#39;5L460&#39;, &#39;5L468&#39;, &#39;5L344&#39;, &#39;5L444&#39;, &#39;5L334&#39;, &#39;5L385&#39;, &#39;5L360&#39;, &#39;5L225&#39;, &#39;5L201&#39;, &#39;5L217&#39;, &#39;5L313&#39;, &#39;5L321&#39;, &#39;5L306&#39;, &#39;5L290&#39;, &#39;5L282&#39;, &#39;5L298&#39;, &#39;5L420&#39;, &#39;5L565&#39;, &#39;5L492&#39;, &#39;5L484&#39;, &#39;5L401&#39;, &#39;5L409&#39;, &#39;5L476&#39;, &#39;5L368&#39;, &#39;5L377&#39;, &#39;5L428&#39;, &#39;5L393&#39;, &#39;5L249&#39;, &#39;5L436&#39;]

==&gt;Analyzing pole 1 (Long_Valley_Caldera_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>20</td>
      <td>87.7</td>
      <td>191.1</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>20</td>
      <td>87.7</td>
      <td>191.1</td>
      <td>7.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_49.png" src="_images/0_Preprocessing_19_49.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_53.png" src="_images/0_Preprocessing_19_53.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Robinson_Antincline_intrusions (6) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [1.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0]

==&gt;Analyzing pole 1 (Robinson_Antincline_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>16</td>
      <td>77.5</td>
      <td>149.8</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>16</td>
      <td>77.5</td>
      <td>149.8</td>
      <td>7.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_57.png" src="_images/0_Preprocessing_19_57.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.5
Critical value of V:  6.9
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 3.7
Critical angle for M&amp;M1990:   13.6
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_59.png" src="_images/0_Preprocessing_19_59.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 3.7º below 13.6º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_63.png" src="_images/0_Preprocessing_19_63.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Central_Mexico_Plio-Pleistocene (7) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 17.0, 18.0, 19.0, 20.0]

==&gt;Analyzing pole 1 (Central_Mexico_Plio-Pleistocene).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>13</td>
      <td>-88.8</td>
      <td>149.5</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>13</td>
      <td>88.5</td>
      <td>331.9</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>13</td>
      <td>88.5</td>
      <td>335.0</td>
      <td>5.3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_67.png" src="_images/0_Preprocessing_19_67.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_71.png" src="_images/0_Preprocessing_19_71.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Rattlesnake_Hills_volcanics (8) =======================
 =&gt; inverted vgp from sites (&#39;name&#39;): [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F*&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;, &#39;K*&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O*&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V*&#39;]

==&gt;Analyzing pole 1 (Rattlesnake_Hills_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>18</td>
      <td>79.4</td>
      <td>146.2</td>
      <td>9.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>18</td>
      <td>79.4</td>
      <td>146.1</td>
      <td>9.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>18</td>
      <td>79.4</td>
      <td>146.1</td>
      <td>9.6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_75.png" src="_images/0_Preprocessing_19_75.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_79.png" src="_images/0_Preprocessing_19_79.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Ramsay_Island_lavas (9) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 37.0, 38.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 60.0, 61.0, 62.0, 63.0, 64.0, 65.0, 66.0, 67.0, 68.0, 69.0, 70.0, 71.0, 72.0, 73.0, 74.0, 75.0]

==&gt;Analyzing pole 1 (Ramsay_Island_lavas).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>11</td>
      <td>78.1</td>
      <td>119.9</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>37</td>
      <td>83.3</td>
      <td>119.2</td>
      <td>5.7</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>37</td>
      <td>83.3</td>
      <td>119.2</td>
      <td>5.7</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_83.png" src="_images/0_Preprocessing_19_83.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_87.png" src="_images/0_Preprocessing_19_87.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Sierra_de_Las_Cruces (10) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;JQ1&#39;, &#39;JQ2&#39;, &#39;JQ3&#39;, &#39;JQ4&#39;, &#39;CM1*&#39;, &#39;AJ1&#39;, &#39;AJ2&#39;, &#39;IT&#39;, &#39;IT2&#39;, &#39;ST2&#39;, &#39;JI1&#39;, &#39;ST3&#39;, &#39;CR**&#39;, &#39;CR2**&#39;, &#39;PL&#39;, &#39;MT*&#39;, &#39;MT2**&#39;, &#39;ST4&#39;, &#39;ST5&#39;, &#39;ST1&#39;, &#39;AY&#39;, &#39;CH1&#39;, &#39;CH2&#39;, &#39;CH3&#39;, &#39;GU3&#39;, &#39;PC2&#39;, &#39;TO1&#39;, &#39;TO3&#39;, &#39;TO2&#39;, &#39;TO4&#39;]

==&gt;Analyzing pole 1 (Sierra_de_Las_Cruces).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>25</td>
      <td>80.1</td>
      <td>161.8</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>25</td>
      <td>80.8</td>
      <td>156.6</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>25</td>
      <td>80.8</td>
      <td>156.6</td>
      <td>4.7</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_91.png" src="_images/0_Preprocessing_19_91.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           4.5
Critical value of V:  6.4
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 9.0
Critical angle for M&amp;M1990:   10.8
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_93.png" src="_images/0_Preprocessing_19_93.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 9.0º below 10.8º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_97.png" src="_images/0_Preprocessing_19_97.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Snake_River_Plain (11) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;sr01&#39;, &#39;sr03&#39;, &#39;sr04&#39;, &#39;sr09&#39;, &#39;sr11&#39;, &#39;sr12&#39;, &#39;sr16&#39;, &#39;sr19&#39;, &#39;sr20&#39;, &#39;sr21&#39;, &#39;sr22&#39;, &#39;sr23&#39;, &#39;sr24&#39;, &#39;sr25&#39;, &#39;sr26&#39;, &#39;sr27&#39;, &#39;sr28&#39;, &#39;sr29&#39;, &#39;sr30&#39;, &#39;sr31&#39;, &#39;sr34&#39;, &#39;sr36&#39;, &#39;sr37&#39;, &#39;sr39&#39;, &#39;sr40&#39;, &#39;sr42&#39;]

==&gt;Analyzing pole 1 (Snake_River_Plain).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>23</td>
      <td>86.9</td>
      <td>7.8</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>23</td>
      <td>86.9</td>
      <td>7.8</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>23</td>
      <td>86.9</td>
      <td>7.8</td>
      <td>6.2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_101.png" src="_images/0_Preprocessing_19_101.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.3
Critical value of V:  6.4
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 2.1
Critical angle for M&amp;M1990:   9.9
The McFadden and McElhinny (1990) classification for
this test is: &#39;B&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_103.png" src="_images/0_Preprocessing_19_103.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 2.1º below 9.9º critical angle); B classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_107.png" src="_images/0_Preprocessing_19_107.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Sonoma_volcanics (12) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [8.0, 9.0, 13.0, 17.0, 18.0, 20.0, 22.0, 23.0, 24.0, 26.0, 27.0, 29.0]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 11.0, 12.0, 14.0, 15.0, 16.0, 19.0, 21.0, 25.0, 28.0, 30.0, 31.0, &#39;SV27 (S28)&#39;, &#39;SV26&#39;, &#39;SV25 (S7)&#39;, &#39;SV24 (S6)&#39;, &#39;SV23&#39;, &#39;SV22&#39;, &#39;SV21&#39;, &#39;SV20&#39;, &#39;SV19 (S4, S5)&#39;, &#39;SV18 (S3)&#39;, &#39;SV17 (S2)&#39;, &#39;SV16&#39;, &#39;SV15&#39;, &#39;SV14&#39;, &#39;SV13&#39;, &#39;SV12&#39;, &#39;SV11 (S19)&#39;, &#39;SV10 (S16)&#39;, &#39;SV9&#39;, &#39;SV8 (S15)&#39;, &#39;SV7 (S14)&#39;, &#39;SV6 (S12)&#39;, &#39;SV5 (S11)&#39;, &#39;SV4 (S21)&#39;, &#39;SV3 (S20)&#39;, &#39;SV2&#39;, &#39;SV1&#39;]

==&gt;Analyzing pole 1 (Sonoma_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>25</td>
      <td>80.2</td>
      <td>69.2</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>26</td>
      <td>80.3</td>
      <td>68.9</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>26</td>
      <td>80.3</td>
      <td>68.8</td>
      <td>6.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_111.png" src="_images/0_Preprocessing_19_111.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           1.2
Critical value of V:  6.8
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 6.0
Critical angle for M&amp;M1990:   14.4
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_113.png" src="_images/0_Preprocessing_19_113.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 6.0º below 14.4º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_117.png" src="_images/0_Preprocessing_19_117.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Mistastin_Lake_impact (13) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [1.0, 2.0, 3.0, &#39;4_adj&#39;, &#39;5_adj&#39;, 6.0, &#39;7_adj&#39;, 8.0, 9.0, 10.0, 12.0, 1.0, 2.0, 3.0, 4.0, 5.0, 11.0, 10.0, 9.0, 6.0, &#39;6-ani&#39;, 7.0, &#39;7-ani&#39;, 13.0, 14.0, 15.0, 17.0]

==&gt;Analyzing pole 1 (Mistastin_Lake_impact).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>10</td>
      <td>85.5</td>
      <td>117.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>10</td>
      <td>85.5</td>
      <td>121.0</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>10</td>
      <td>85.5</td>
      <td>121.0</td>
      <td>4.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_123.png" src="_images/0_Preprocessing_19_123.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Mistastin_Lake_impact).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>15</td>
      <td>83.7</td>
      <td>99.9</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>15</td>
      <td>83.7</td>
      <td>99.9</td>
      <td>4.1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_127.png" src="_images/0_Preprocessing_19_127.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_131.png" src="_images/0_Preprocessing_19_131.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Bighorn_Basin_sediments (14) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;BH0414β&#39;, &#39;BH0401α&#39;, &#39;BH0403α&#39;, &#39;BH0404α&#39;, &#39;BH0405α&#39;, &#39;BH0407α&#39;, &#39;BH0408α&#39;, &#39;BH0410α&#39;, &#39;BH0412β&#39;, &#39;BH02015α&#39;, &#39;BH02016β&#39;, &#39;BH02019β&#39;, &#39;BH02018β&#39;, &#39;BH02020β&#39;, &#39;BH02021β&#39;, &#39;BH0415α&#39;, &#39;BH0416α&#39;, &#39;BH0417α&#39;, &#39;BH0418β&#39;, &#39;BH0419α&#39;, &#39;BH0420α&#39;, &#39;BH0421α&#39;, &#39;BH0422α&#39;, &#39;BH02034α&#39;, &#39;BH02035α&#39;, &#39;BH02037α&#39;, &#39;BH02038α&#39;, &#39;BH02039α&#39;, &#39;BH02040α&#39;, &#39;BH02041α&#39;, &#39;BH02042α&#39;, &#39;BH02043α&#39;, &#39;BH02044α&#39;, &#39;BH0423α&#39;, &#39;BH0424α&#39;, &#39;BH0425α&#39;, &#39;BH0426a&#39;, &#39;BH0427β&#39;, &#39;BH0433β&#39;, &#39;BH01025α&#39;, &#39;BH01027α&#39;, &#39;BH01028α&#39;, &#39;BH01031α&#39;, &#39;BH01033β&#39;, &#39;BH01036β&#39;, &#39;BH01037β&#39;, &#39;BH01038α&#39;, &#39;BH01039α&#39;, &#39;BH01040α&#39;, &#39;BH01041β&#39;, &#39;BH01042β&#39;, &#39;BH01043α&#39;, &#39;BH01045α&#39;, &#39;BH01046α&#39;, &#39;BH01049α&#39;, &#39;BH01050α&#39;, &#39;BH01051α&#39;, &#39;BH01052β&#39;, &#39;BH01053α&#39;, &#39;BH01054β&#39;, &#39;BH01055α&#39;, &#39;BH01056β&#39;, &#39;BH01057β&#39;, &#39;BH01061β&#39;, &#39;BH01064α&#39;, &#39;BH01066β&#39;, &#39;BH01068β&#39;, &#39;BH01071β&#39;, &#39;BH01073α&#39;, &#39;BH01075β&#39;, &#39;BH01076α&#39;, &#39;BH01077α&#39;, &#39;BH01079β&#39;, &#39;BH01080α&#39;, &#39;BH01081β&#39;, &#39;BH01086β&#39;, &#39;BH01089β&#39;, &#39;BH01090β&#39;, &#39;BH01091α&#39;, &#39;BH01092α&#39;, &#39;BH01001β&#39;, &#39;BH01011β&#39;, &#39;BH01018β&#39;, &#39;BH01019β&#39;, &#39;BH01022α&#39;, &#39;BH01023α&#39;, &#39;BH01101β&#39;, &#39;BH02054α&#39;, &#39;BH01096α&#39;, &#39;BH01097α&#39;, &#39;BH02060α&#39;, &#39;BH02050α&#39;, &#39;BH02051α&#39;]

==&gt;Analyzing pole 1 (Bighorn_Basin_sediments).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>59</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>59</td>
      <td>81.6</td>
      <td>182.8</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>59</td>
      <td>81.5</td>
      <td>182.8</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_135.png" src="_images/0_Preprocessing_19_135.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail, distinct in x, y and z

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           24.4
Critical value of V:  6.4
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 19.2
Critical angle for M&amp;M1990:   9.8


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_137.png" src="_images/0_Preprocessing_19_137.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 19.2º above 9.8º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_141.png" src="_images/0_Preprocessing_19_141.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Absaroka_volcanics (15) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [10.0, &#39;Lower Flow mean&#39;, &#39;Middle Flow mean&#39;, &#39;Upper Flow mean&#39;, 620.0, 622.0, 617.0, &#39;617+624+625 mean&#39;, &#39;I8&#39;]

 =&gt; inverted vgp from sites (&#39;name&#39;): [&#39;7*&#39;, 8.0, &#39;35*&#39;, &#39;4b&#39;, &#39;4a&#39;, 4.0, &#39;5b&#39;, &#39;5a&#39;, 5.0, 44.0, &#39;43*&#39;, &#39;3b&#39;, &#39;3a&#39;, 3.0, &#39;2b&#39;, &#39;2a&#39;, &#39;2*&#39;, &#39;16b&#39;, &#39;16a&#39;, 16.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0, 50.0, 51.0, 52.0, 55.0, 57.0, 58.0, 59.0, 60.0, 61.0, 62.0, 389.0, 390.0, &#39;389+390 mean&#39;, 394.0, 396.0, 624.0, 625.0, &#39;I1&#39;, &#39;I2&#39;, &#39;I3&#39;, &#39;I4&#39;, &#39;I6&#39;, &#39;I7&#39;, &#39;Independence stock mean&#39;, &#39;I5&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [6.0, &#39;33*&#39;, &#39;34*&#39;, &#39;36*&#39;, &#39;37*&#39;, &#39;38*&#39;, 39.0, 40.0, &#39;41*&#39;, 51.0, &#39;50*&#39;, &#39;49*&#39;, 48.0, &#39;47*&#39;, 31.0, 32.0, 14.0, &#39;13*&#39;, 12.0, 11.0, 9.0, 1.0, &#39;15*&#39;, 615.0, 395.0, &#39;AS1&#39;, &#39;AS2&#39;, &#39;AS3&#39;, &#39;AS4&#39;, 618.0, &#39;618+620 mean&#39;, 558.0, 557.0, 448.0, 621.0, &#39;448+621 mean&#39;, 628.0, 635.0, 627.0, 616.0, &#39;HY-1&#39;, 923.0]

==&gt;Analyzing pole 1 (Absaroka_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>19</td>
      <td>83.5</td>
      <td>177.4</td>
      <td>10.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>19</td>
      <td>83.4</td>
      <td>178.6</td>
      <td>11.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>19</td>
      <td>83.4</td>
      <td>178.6</td>
      <td>11.1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_145.png" src="_images/0_Preprocessing_19_145.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           1.1
Critical value of V:  7.0
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 9.0
Critical angle for M&amp;M1990:   22.4
The McFadden and McElhinny (1990) classification for
this test is: &#39;INDETERMINATE;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_147.png" src="_images/0_Preprocessing_19_147.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 9.0º below 22.4º critical angle); indeterminate classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_151.png" src="_images/0_Preprocessing_19_151.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Absaroka_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>3</td>
      <td>65.6</td>
      <td>94.6</td>
      <td>58.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>3</td>
      <td>65.6</td>
      <td>94.6</td>
      <td>58.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_157.png" src="_images/0_Preprocessing_19_157.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 3 (Absaroka_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>22</td>
      <td>80.8</td>
      <td>145.9</td>
      <td>8.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>22</td>
      <td>80.8</td>
      <td>146.7</td>
      <td>8.6</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>22</td>
      <td>80.8</td>
      <td>146.6</td>
      <td>8.6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_161.png" src="_images/0_Preprocessing_19_161.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           2.9
Critical value of V:  6.7
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 8.0
Critical angle for M&amp;M1990:   12.2
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_163.png" src="_images/0_Preprocessing_19_163.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 8.0º below 12.2º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_167.png" src="_images/0_Preprocessing_19_167.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Eastern_TMVB (16) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;SM1&#39;, &#39;SM2*&#39;, &#39;SM3&#39;, &#39;SM4&#39;, &#39;SM5&#39;, &#39;SM6*&#39;, &#39;SM7&#39;, &#39;SM8&#39;, &#39;SM9*&#39;, &#39;SM10*&#39;, &#39;SM11&#39;, &#39;SM12*&#39;, &#39;SM13&#39;, &#39;SM14&#39;, &#39;SM15&#39;, &#39;SM16&#39;, &#39;SM17&#39;, &#39;PS2 (VE34)&#39;, &#39;PS3* (VE71b)&#39;, &#39;PS4 (VE15)&#39;, &#39;PS1 (VE108)&#39;, &#39;CA2&#39;, &#39;MC2&#39;, &#39;MM1&#39;, &#39;XO1 (VE118)&#39;, &#39;CY1 (VE118)&#39;, &#39;MI1 (VE118)&#39;, &#39;MR1* (VE118)&#39;, &#39;JA1 (PH113)&#39;, &#39;TRT (TH24)&#39;, &#39;MO1 (PH171)&#39;, &#39;MZ1 (PH135)&#39;, &#39;ZC1 (PH141)&#39;, &#39;MS2-3 (VE94)&#39;, &#39;ZC2&#39;, &#39;SB1&#39;, &#39;ZC3&#39;, &#39;PL1 (PH62)&#39;, &#39;AT1 (PH40)&#39;]

==&gt;Analyzing pole 1 (Eastern_TMVB).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>12</td>
      <td>86.8</td>
      <td>96.8</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>12</td>
      <td>86.3</td>
      <td>116.9</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>12</td>
      <td>86.3</td>
      <td>116.9</td>
      <td>6.8</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_171.png" src="_images/0_Preprocessing_19_171.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_175.png" src="_images/0_Preprocessing_19_175.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Eastern_TMVB).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>3</td>
      <td>82.1</td>
      <td>190.7</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>3</td>
      <td>82.5</td>
      <td>180.8</td>
      <td>14.3</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>3</td>
      <td>82.5</td>
      <td>180.8</td>
      <td>14.3</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_181.png" src="_images/0_Preprocessing_19_181.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 3 (Eastern_TMVB).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>17</td>
      <td>80.5</td>
      <td>188.1</td>
      <td>8.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>17</td>
      <td>79.8</td>
      <td>186.2</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>17</td>
      <td>79.8</td>
      <td>186.2</td>
      <td>8.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_185.png" src="_images/0_Preprocessing_19_185.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.1
Critical value of V:  6.7
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 1.7
Critical angle for M&amp;M1990:   18.1
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_187.png" src="_images/0_Preprocessing_19_187.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 1.7º below 18.1º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_191.png" src="_images/0_Preprocessing_19_191.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Bishop_tuff (17) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;B1&#39;, &#39;B2&#39;, &#39;B3&#39;, &#39;B4&#39;, &#39;B5&#39;, &#39;B6&#39;, &#39;B7&#39;, &#39;B8&#39;, &#39;B9&#39;, &#39;B10&#39;, &#39;B11&#39;, &#39;B12&#39;, &#39;B13&#39;, &#39;B14&#39;, &#39;B15&#39;, &#39;B16&#39;, &#39;B17&#39;, &#39;B18&#39;, &#39;B19&#39;, &#39;B20&#39;, &#39;B21&#39;, &#39;B23&#39;, &#39;B24&#39;, &#39;B25 (0 m)&#39;, &#39;B25 (3 m)&#39;, &#39;B25 (6 m)&#39;, &#39;B25 (9 m)&#39;, &#39;B25 (12 m)&#39;, &#39;B25 (15 m)&#39;, &#39;B25 (18 m)&#39;, &#39;B25 (21 m)&#39;, &#39;B25 (24 m)&#39;, &#39;B25 (27 m)&#39;, &#39;B25 (30 m)&#39;, &#39;B25 (33 m)&#39;, &#39;B26&#39;, &#39;B27&#39;, &#39;C001&#39;, &#39;C041&#39;, &#39;C051&#39;, &#39;C071&#39;, &#39;C615&#39;, &#39;C621&#39;, &#39;C530&#39;, &#39;C538&#39;, &#39;Xen&#39;, &#39;LT&#39;, &#39;Bishop Tuff mean&#39;]

==&gt;Analyzing pole 1 (Bishop_tuff).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_197.png" src="_images/0_Preprocessing_19_197.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Western_Central_TMVB (18) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;mwrSF&#39;, &#39;pwrIXT&#39;, &#39;pcrTRA&#39;, &#39;qcnPAR&#39;, &#39;pcnBRI&#39;]

 =&gt; inverted vgp from sites (&#39;name&#39;): [&#39;pwrLIB&#39;, &#39;pwnPAL&#39;, &#39;pwrJAL&#39;, &#39;pwrSJG&#39;, &#39;pwrFER&#39;, &#39;mcrARE&#39;, &#39;pcrCHA&#39;, &#39;mcrFIN&#39;, &#39;pcrTRO&#39;, &#39;pcrOCO&#39;, &#39;qcrCG&#39;, &#39;pcrPEN&#39;, &#39;qcrEST&#39;, &#39;qcrROD&#39;, &#39;qcrCSA&#39;, &#39;pcrHUA&#39;, &#39;pcrSOL&#39;, &#39;mcrCAN&#39;, &#39;mcrORD&#39;, &#39;mcrAZU&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;mwnHIG&#39;, &#39;pwnPLA&#39;, &#39;pwrJOL&#39;, &#39;qwnTEQ&#39;, &#39;pcnZAP&#39;, &#39;mcnBAJ&#39;, &#39;mcnLN&#39;, &#39;mcnTEP&#39;, &#39;mcnPEP&#39;, &#39;pcnPAJ&#39;, &#39;mcnPEV&#39;, &#39;mcnSMA&#39;, &#39;pcnCAL&#39;, &#39;mcnJALO&#39;, &#39;mcnSJU&#39;, &#39;qcnAGU&#39;, &#39;qcnTZAR&#39;, &#39;pcnBDI&#39;, &#39;pcnGUA&#39;, &#39;pcnPSA&#39;, &#39;pcnVIR&#39;, &#39;pcnELD&#39;, &#39;qcnCOP&#39;, &#39;qcnSOM&#39;, &#39;qcnSM&#39;, &#39;qcnAHOR&#39;]

==&gt;Analyzing pole 1 (Western_Central_TMVB).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>10</td>
      <td>86.7</td>
      <td>314.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>10</td>
      <td>86.7</td>
      <td>314.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>10</td>
      <td>86.7</td>
      <td>313.9</td>
      <td>7.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_201.png" src="_images/0_Preprocessing_19_201.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.9
Critical value of V:  7.1
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 5.6
Critical angle for M&amp;M1990:   15.9
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 5.6º below 15.9º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_205.png" src="_images/0_Preprocessing_19_205.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Western_Central_TMVB).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>33</td>
      <td>88.0</td>
      <td>265.5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>33</td>
      <td>87.9</td>
      <td>270.8</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>33</td>
      <td>87.9</td>
      <td>270.6</td>
      <td>5.1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_209.png" src="_images/0_Preprocessing_19_209.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.7
Critical value of V:  6.4
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 3.6
Critical angle for M&amp;M1990:   11.1
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_211.png" src="_images/0_Preprocessing_19_211.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 3.6º below 11.1º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_215.png" src="_images/0_Preprocessing_19_215.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Dinan_Bay_lavas (19) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [46.0, 47.0, 48.0, 49.0, 51.0, 52.0, 53.0, 54.0, 55.0, 56.0, 57.0, 58.0, 59.0]

==&gt;Analyzing pole 1 (Dinan_Bay_lavas).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>13</td>
      <td>83.3</td>
      <td>137.8</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>13</td>
      <td>83.3</td>
      <td>144.3</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>13</td>
      <td>83.3</td>
      <td>144.3</td>
      <td>9.8</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_219.png" src="_images/0_Preprocessing_19_219.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail, distinct in y

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           1.2
Critical value of V:  8.7
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 8.1
Critical angle for M&amp;M1990:   22.3
The McFadden and McElhinny (1990) classification for
this test is: &#39;INDETERMINATE;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_221.png" src="_images/0_Preprocessing_19_221.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 8.1º below 22.3º critical angle); indeterminate classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_225.png" src="_images/0_Preprocessing_19_225.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Valles_Caldera_volcanics (20) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;S47&#39;, &#39;S46&#39;, &#39;S45&#39;, &#39;S44&#39;, &#39;S43&#39;, &#39;S42&#39;, &#39;S41&#39;, &#39;S40&#39;, &#39;S39&#39;, &#39;S38&#39;, &#39;S37&#39;, &#39;S35&#39;, &#39;S34&#39;, &quot;Anorthoclase&#39; unit&quot;, 5.0, 4.0, 3.0, 2.0, 1.0, &#39;S31: Upper member mean&#39;, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, &#39;S30: Lower member mean&#39;, &#39;S29&#39;]

==&gt;Analyzing pole 1 (Valles_Caldera_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>11</td>
      <td>87.1</td>
      <td>38.6</td>
      <td>13.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>11</td>
      <td>87.1</td>
      <td>38.5</td>
      <td>13.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_229.png" src="_images/0_Preprocessing_19_229.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.6
Critical value of V:  8.1
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 6.6
Critical angle for M&amp;M1990:   24.5
The McFadden and McElhinny (1990) classification for
this test is: &#39;INDETERMINATE;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_231.png" src="_images/0_Preprocessing_19_231.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 6.6º below 24.5º critical angle); indeterminate classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_235.png" src="_images/0_Preprocessing_19_235.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Bitterroot_Dome_intrusions (21) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;B01&#39;, &#39;B02&#39;, &#39;B03&#39;, &#39;B05&#39;, &#39;B06&#39;, &#39;B09&#39;, &#39;B09a&#39;, &#39;B09b&#39;, &#39;B10&#39;, &#39;B11&#39;, &#39;B11a&#39;, &#39;B11b&#39;, &#39;B12&#39;, &#39;B12a&#39;, &#39;B12b&#39;, &#39;B15&#39;, &#39;B15a&#39;, &#39;B15b&#39;, &#39;B18&#39;, &#39;S03&#39;, &#39;S04&#39;, &#39;S07&#39;, &#39;S10&#39;, &#39;S12&#39;, &#39;S13&#39;, &#39;S16&#39;, &#39;S17&#39;]

==&gt;Analyzing pole 1 (Bitterroot_Dome_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>11</td>
      <td>72.3</td>
      <td>165.0</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>11</td>
      <td>72.2</td>
      <td>164.4</td>
      <td>7.9</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_239.png" src="_images/0_Preprocessing_19_239.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.4
Critical value of V:  7.7
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 2.9
Critical angle for M&amp;M1990:   13.4
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_241.png" src="_images/0_Preprocessing_19_241.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 2.9º below 13.4º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_245.png" src="_images/0_Preprocessing_19_245.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Bitterroot_Dome_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>8</td>
      <td>59.3</td>
      <td>301.6</td>
      <td>20.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>8</td>
      <td>59.2</td>
      <td>302.1</td>
      <td>20.8</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_249.png" src="_images/0_Preprocessing_19_249.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           3.7
Critical value of V:  7.9
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 17.7
Critical angle for M&amp;M1990:   25.8
The McFadden and McElhinny (1990) classification for
this test is: &#39;INDETERMINATE;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Ambiguous: weak support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 17.7º below 25.8º critical angle); indeterminate classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Ambiguous: weak support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_253.png" src="_images/0_Preprocessing_19_253.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Stoddard_Mountain_laccolith (22) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;SM13&#39;, &#39;SM14&#39;, &#39;SM15&#39;, &#39;SM28&#39;, &#39;SM31&#39;, &#39;SM44&#39;, &#39;SM45&#39;, &#39;SM66&#39;, &#39;SM73&#39;, &#39;mean of chilled zone&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;SM1&#39;, &#39;SM2&#39;, &#39;SM3&#39;, &#39;SM4&#39;, &#39;SM5&#39;, &#39;SM6&#39;, &#39;SM7&#39;, &#39;SM9&#39;, &#39;SM10&#39;, &#39;SM11&#39;, &#39;SM12&#39;, &#39;SM16&#39;, &#39;SM17&#39;, &#39;SM18&#39;, &#39;SM19&#39;, &#39;SM21&#39;, &#39;SM22&#39;, &#39;SM23&#39;, &#39;SM24&#39;, &#39;SM25&#39;, &#39;SM26&#39;]

==&gt;Analyzing pole 1 (Stoddard_Mountain_laccolith).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>19</td>
      <td>83.8</td>
      <td>153.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>19</td>
      <td>83.8</td>
      <td>153.6</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_257.png" src="_images/0_Preprocessing_19_257.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_261.png" src="_images/0_Preprocessing_19_261.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Michoacan_Guanajuato_volcanic_field (23) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;Tan1 (TV)&#39;, &#39;Tan2 (TV)&#39;, &#39;Tan3 (UR-4)&#39;, &#39;Tan5 (Tan28)&#39;, &#39;Tan6 (Tan26)&#39;, &#39;Tan7 (Tan10)&#39;, &#39;Tan8 (Tan43)&#39;, &#39;Tan9 (Tan 43)&#39;, &#39;Tan10 (NI 19)&#39;, &#39;Tan11 (NI 18)&#39;]

==&gt;Analyzing pole 1 (Michoacan_Guanajuato_volcanic_field).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>8</td>
      <td>84.4</td>
      <td>219.9</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>8</td>
      <td>83.1</td>
      <td>222.7</td>
      <td>10.1</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>8</td>
      <td>83.1</td>
      <td>222.7</td>
      <td>10.1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_267.png" src="_images/0_Preprocessing_19_267.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Clear_Lake_volcanic_field (24) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;r-1&#39;, &#39;ast-1&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;dcv-1&#39;, &#39;dcv-2&#39;, &#39;dcv-3&#39;, &#39;dc-1&#39;, &#39;dc-2&#39;, &#39;ra-1&#39;, &#39;ra-2&#39;, &#39;ra-3&#39;, &#39;ra-4&#39;, &#39;ra-5&#39;, &#39;ra-6&#39;, &#39;rb&#39;, &#39;dh&#39;, &#39;dsb&#39;, &#39;r-2&#39;, &#39;ds&#39;, &#39;dhm-1&#39;, &#39;dhm-2&#39;, &#39;dhm-3&#39;, &#39;dhc&#39;, &#39;dhf&#39;, &#39;aps-1&#39;, &#39;aps-2&#39;, &#39;aps-3&#39;, &#39;aps mean&#39;, &#39;dl&#39;, &#39;ast-2&#39;, &#39;ac&#39;, &#39;aph&#39;, &#39;asc&#39;, &#39;db-1&#39;, &#39;db-2&#39;, &#39;asf-1&#39;, &#39;asf-2&#39;, &#39;asf-3&#39;, &#39;ag&#39;, &#39;ra-7&#39;]

==&gt;Analyzing pole 1 (Clear_Lake_volcanic_field).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>3</td>
      <td>84.9</td>
      <td>118.9</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>3</td>
      <td>84.9</td>
      <td>118.9</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_273.png" src="_images/0_Preprocessing_19_273.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : San_Luis_Hills_volcanics (25) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [1.0, 2.0, 4.0, 5.0, 7.0, 8.0, 9.0, 12.0, 13.0, 14.0, 15.0, 16.0, 18.0, 20.0, 21.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0]

==&gt;Analyzing pole 1 (San_Luis_Hills_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>23</td>
      <td>79.7</td>
      <td>162.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>23</td>
      <td>79.7</td>
      <td>169.5</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>23</td>
      <td>79.7</td>
      <td>169.5</td>
      <td>8.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_277.png" src="_images/0_Preprocessing_19_277.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           0.4
Critical value of V:  6.4
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 3.1
Critical angle for M&amp;M1990:   11.5
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_279.png" src="_images/0_Preprocessing_19_279.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 3.1º below 11.5º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_283.png" src="_images/0_Preprocessing_19_283.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Beaver_River_intrusions (26) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;01 LCE&#39;, &#39;02 LCE&#39;, &#39;03 LCE&#39;, &#39;04 LCE&#39;, &#39;05 LCE&#39;, &#39;06 LCE&#39;, &#39;07 LCE&#39;, &#39;08 LCE&#39;, &#39;09 LCW*&#39;, &#39;10 LCW&#39;, &#39;11 LCW&#39;, &#39;12 LCW&#39;, &#39;13 LCW*&#39;, &#39;14 LCW&#39;, &#39;16 LCW&#39;, &#39;17 LCW*&#39;, &#39;18 BR&#39;, &#39;19 BR&#39;, &#39;20 BR&#39;, &#39;21 BR&#39;, &#39;22 BR&#39;, &#39;23 BR&#39;, &#39;24 BR&#39;, &#39;25 BR*&#39;, &#39;26 BR&#39;]

==&gt;Analyzing pole 1 (Beaver_River_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>21</td>
      <td>79.2</td>
      <td>145.8</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>21</td>
      <td>79.3</td>
      <td>147.7</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>21</td>
      <td>79.3</td>
      <td>147.7</td>
      <td>4.8</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_287.png" src="_images/0_Preprocessing_19_287.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           7.3
Critical value of V:  6.7
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 6.0
Critical angle for M&amp;M1990:   5.8


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Common mean: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_289.png" src="_images/0_Preprocessing_19_289.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 6.0º above 5.8º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Common mean: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_293.png" src="_images/0_Preprocessing_19_293.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Mariscal_Mtn_intrusions (27) =======================
 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;mm8&#39;, &#39;mm9&#39;, &#39;mm10&#39;, &#39;mm12&#39;, &#39;mm13&#39;, &#39;mm18&#39;, &#39;mm19*&#39;, &#39;mm20&#39;, &#39;mm21&#39;, &#39;mm22*&#39;, &#39;mm23&#39;, &#39;mm24&#39;, &#39;mm25&#39;, &#39;mm26&#39;, &#39;mm30&#39;, &#39;mm31&#39;, &#39;mm37&#39;, &#39;mm39&#39;, &#39;mm42a&#39;, &#39;mm42b*&#39;, &#39;mm44&#39;]

==&gt;Analyzing pole 1 (Mariscal_Mtn_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>18</td>
      <td>80.0</td>
      <td>185.3</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>18</td>
      <td>80.0</td>
      <td>185.2</td>
      <td>5.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>18</td>
      <td>80.0</td>
      <td>185.3</td>
      <td>5.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_297.png" src="_images/0_Preprocessing_19_297.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_301.png" src="_images/0_Preprocessing_19_301.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Mogollon-Datil_volcanics (28) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;74#&#39;, 6.0, &#39;33#&#39;, &#39;19#&#39;, &#39;44#&#39;, &#39;48#&#39;, &#39;73#&#39;, &#39;78#&#39;, 24.0, 25.0, 55.0, 137.0, 183.0, 185.0, 186.0, 199.0, 215.0, 216.0, 217.0, 218.0, 219.0, 338.0, 348.0, 364.0, 424.0, 176.0, 184.0, 115.0, 471.0, 473.0, &#39;Slash Ranch mean&#39;, 4.0, 7.0, 36.0, 105.0, 138.0, 187.0, 188.0, 197.0, 250.0, 251.0, 252.0, 258.0, 380.0, 515.0, 8.0, 242.0, 13.0, 166.0, 53.0, 58.0, 60.0, 61.0, 63.0, 80.0, 81.0, 82.0, 172.0, 57.0, 62.0, 47.0, 59.0, 19.0, 20.0, 23.0, 26.0, 27.0, 28.0, 29.0, 173.0, 367.0, &#39;368&#39;, 369.0, 370.0, 510.0, 9.0, 21.0, 22.0, 46.0, 54.0, 56.0, 104.0, 161.0, 165.0, 198.0, 10.0, 11.0, 12.0, 30.0, 40.0, 41.0, 45.0, 196.0, 50.0, 64.0, 162.0, &#39;Lemitar mean&#39;, 167.0, 168.0, 195.0, 545.0, 543.0, 140.0, 141.0, 142.0, 158.0, 160.0, 159.0, 78.0, 94.0, 95.0, 101.0, 112.0, 114.0, 139.0, 144.0, 148.0, 155.0, 228.0, 230.0, 266.0, 298.0, 318.0, 332.0, 428.0, 429.0, 430.0, 431.0, 432.0, 514.0, 153.0, 259.0, 486.0, &#39;Apache Springs mean&#39;, &#39;Diablo Range&#39;, 77.0, 100.0, 149.0, 262.0, 299.0, 301.0, 492.0, 504.0, 149.0, 303.0, 113.0, 227.0, 319.0, 333.0, 334.0, 335.0, 337.0, 37.0, 68.0, 75.0, 97.0, 98.0, 108.0, 109.0, 119.0, 143.0, 147.0, 163.0, 171.0, 182.0, 190.0, 243.0, 248.0, 315.0, 325.0, 345.0, 361.0, 381.0, 408.0, 414.0, 502.0, 6.0, 48.0, 133.0, 175.0, 344.0, 351.0, 389.0, 394.0, 441.0, 16.0, 18.0, 34.0, 49.0, 67.0, 74.0, 111.0, 120.0, 146.0, 191.0, 193.0, 194.0, 346.0, 352.0, 372.0, 135.0, 5.0, 17.0, 32.0, 33.0, 76.0, 164.0, 247.0, 467.0, 96.0, 261.0, 267.0, 493.0, 494.0, 503.0, 302.0, 157.0, 257.0, 421.0, 480.0, 235.0, 495.0, 496.0, 506.0, &#39;Tadpole Ridge upper member mean&#39;, 102.0, 156.0, 477.0, 479.0, 497.0, 507.0, 128.0, 200.0, 236.0, 254.0, 268.0, &#39;Table Mountain tuff mean&#39;, 79.0, 229.0, 305.0, &#39;Cooney mean&#39;, 70.0, 86.0, 89.0, 239.0, 371.0, 403.0, 439.0, 468.0, 517.0, 145.0, 405.0, &#39;Mimbres Peak&#39;, 88.0, 231.0, 438.0, 436.0, 404.0, 92.0, 103.0, 110.0, 118.0, 123.0, 126.0, 179.0, 202.0, 208.0, 210.0, 256.0, 294.0, 295.0, 314.0, 324.0, 374.0, 383.0, 416.0, 420.0, 456.0, 465.0, 127.0, 376.0, 498.0, 311.0, 384.0, 412.0, 413.0, 177.0, 212.0, 213.0, 411.0, &#39;Stone House Ranch mean&#39;, 125.0, 206.0, 209.0, 211.0, 317.0, &#39;Bell Top tuff 4 mean&#39;, 65.0, 66.0, 71.0, 91.0, 308.0, 316.0, 388.0, 390.0, 437.0, 238.0, 313.0, 178.0, 385.0, 85.0, 90.0, 237.0, 466.0, 481.0, &#39;Datil Well mean&#39;, 462.0, 455.0, 461.0, &#39;lower Sugarlump tuffs mean&#39;, 460.0, 509.0, &#39;upper Sugarlump tuffs mean&#39;, 458.0, 463.0, 512.0, 513.0, 122.0, 205.0, &#39;Bell Top tuff 3 mean&#39;, 121.0, 204.0, &#39;Bell Top tuff 2 mean&#39;, 130.0, 203.0, &#39;Dona Ana mean&#39;, 417.0, 529.0, &#39;Squaw Mountain mean&#39;, 418.0, 419.0, 484.0, &#39;Achenback Park mean&#39;, 482.0, 485.0, 483.0, &#39;Cueva mean&#39;, 150.0, 151.0, 152.0, 174.0, 214.0, 220.0, 221.0, 222.0, 223.0, 224.0, 225.0, 264.0, 265.0, 307.0, 309.0, 320.0, 323.0, 327.0, 330.0, 340.0, 341.0, 342.0, 347.0, 360.0, 362.0, 365.0, 378.0, 382.0, 396.0, 398.0, 425.0, 427.0, 445.0, 448.0, 454.0, 457.0, 475.0, 339.0, 51.0, 249.0, 189.0, 474.0, 442.0, 331.0, 489.0, 476.0, 116.0, 117.0, 336.0, 52.0, 350.0, 241.0, 245.0, 366.0, 373.0, 377.0, 469.0, 470.0, 409.0, 446.0, 447.0, 449.0, 450.0, 72.0, 530.0, 357.0, 452.0, 453.0, 459.0, 464.0, 180.0, 426.0, 363.0, 35.0, 244.0, 326.0, 379.0, 99.0, 393.0, 136.0, 353.0, 440.0, 402.0, 410.0, 401.0, 407.0, 444.0, 400.0, 406.0, 356.0, 43.0, 355.0, 322.0, 44.0, 310.0, 358.0, 395.0, 359.0, 397.0, 391.0, 392.0, 87.0, 399.0]

 =&gt; inverted vgp from sites (&#39;name&#39;): [1.0, 2.0, 3.0, 30.0, 31.0, 32.0, &#39;21#&#39;, 22.0, 23.0, 62.0, 63.0, 66.0, 67.0, 75.0, 77.0, &#39;80#&#39;, &#39;81#&#39;, 7.0, 8.0, 38.0, &#39;8/38&#39;, 11.0, 47.0, &#39;11/47&#39;, 12.0, 53.0, &#39;12/53&#39;, 90.0, 14.0, 15.0, &#39;14/15&#39;, 16.0, 17.0, 82.0, 83.0, &#39;16/17/82/83&#39;, 18.0, 61.0, &#39;18/61&#39;, 26.0, 34.0, 39.0, 35.0, &#39;34/39&#39;, 36.0, 37.0, 40.0, 45.0, 43.0, 50.0, 51.0, 52.0, 55.0, 56.0, 71.0, &#39;52/55/56/71&#39;, 57.0, 59.0, 91.0, 94.0, 79.0, &#39;Turkey Springs mean&#39;, &#39;Bloodgood Canyon mean&#39;, &#39;La Jencia mean&#39;, &#39;Davis Canyon mean&#39;, &#39;Caballo Blanco mean&#39;, &#39;Hells Mesa mean&#39;, &#39;Box Canyon tuff mean&#39;, &#39;Blue Canyon tuff mean&#39;, &#39;Rockhouse Canyon mean&#39;, &#39;Lebya Well mean&#39;, &#39;Kneeling Nun mean&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;4#&#39;, 24.0, 25.0, &#39;64#&#39;, 65.0, 84.0, 85.0, 86.0, 87.0, 88.0, 92.0, 93.0, 5.0, 9.0, 49.0, &#39;9/49&#39;, 10.0, 68.0, 69.0, &#39;68/69&#39;, 70.0, 27.0, 28.0, 29.0, &#39;41#&#39;, 42.0, 46.0, 72.0, 89.0, &#39;South Canyon overall mean&#39;, &#39;Caronita Canyon mean&#39;, &#39;Triangle C Ranch mean&#39;, &#39;Shelley Peak mean&#39;, &#39;Garcia Camp mean&#39;, &#39;Vicks Peak mean&#39;, &#39;Tadpole Ridge lower member mean&#39;, &#39;Farr Ranch mean&#39;]

==&gt;Analyzing pole 1 (Mogollon-Datil_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>61</td>
      <td>81.9</td>
      <td>143.6</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>61</td>
      <td>82.0</td>
      <td>143.4</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>61</td>
      <td>81.9</td>
      <td>143.3</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_305.png" src="_images/0_Preprocessing_19_305.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail, distinct in x and z

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           15.5
Critical value of V:  6.2
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 13.0
Critical angle for M&amp;M1990:   8.2


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: positive support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_307.png" src="_images/0_Preprocessing_19_307.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 13.0º above 8.2º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: positive support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_311.png" src="_images/0_Preprocessing_19_311.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Mogollon-Datil_volcanics).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>106</td>
      <td>78.8</td>
      <td>175.0</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>110</td>
      <td>81.4</td>
      <td>163.1</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>110</td>
      <td>80.4</td>
      <td>166.9</td>
      <td>4.2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_315.png" src="_images/0_Preprocessing_19_315.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail, distinct in x and z

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           10.4
Critical value of V:  6.3
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 9.6
Critical angle for M&amp;M1990:   7.4


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Ambiguous: weak support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_317.png" src="_images/0_Preprocessing_19_317.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 9.6º above 7.4º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Ambiguous: weak support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_321.png" src="_images/0_Preprocessing_19_321.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Monterey_intrusions (29) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [1.0, 2.0, 3.0, 6.0, 7.0, 8.0]

==&gt;Analyzing pole 1 (Monterey_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>6</td>
      <td>87.6</td>
      <td>46.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>6</td>
      <td>87.6</td>
      <td>46.2</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough sites from one (or both) polarity populations to conduct Bootstrap and parametric reversal tests

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
Not enough sites to conduct Q-Q test
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Too few sites for test</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Too few sites</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_327.png" src="_images/0_Preprocessing_19_327.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Monterey_intrusions).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>11</td>
      <td>85.5</td>
      <td>243.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>11</td>
      <td>83.9</td>
      <td>258.7</td>
      <td>12.2</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>11</td>
      <td>83.9</td>
      <td>258.7</td>
      <td>12.2</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
Only one polarity; cannot conduct reversal tests
Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_331.png" src="_images/0_Preprocessing_19_331.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Only one polarity</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_335.png" src="_images/0_Preprocessing_19_335.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>========================= NEW POLE : Latir_volcanic_field (30) =======================
 =&gt; Missing reported VGPs from sites (&#39;name&#39;): [&#39;QL1-2&#39;, &#39;QL2-2&#39;, &#39;QL3-2&#39;, &#39;QL5-2&#39;, &#39;QL7-2&#39;, &#39;QL8-2&#39;, &#39;AT3-2&#39;, &#39;AT4-2&#39;, &#39;AT5-2&#39;, &#39;AT6-2&#39;, &#39;AT8-2&#39;, &#39;AT9-2&#39;, &#39;AT15-2&#39;, &#39;AT16-2&#39;, &#39;Amalia Tuff mean&#39;, &#39;AB1&#39;, &#39;LP4&#39;, &#39;VC4*&#39;]

 =&gt; Coherent dec/inc in sites (&#39;name&#39;): [&#39;A1&#39;, &#39;A2&#39;, &#39;A3&#39;, &#39;A4&#39;, &#39;A5&#39;, &#39;A6&#39;, &#39;A7&#39;, &#39;A8&#39;, &#39;A9&#39;, &#39;A10&#39;, &#39;A11&#39;, &#39;A12&#39;, &#39;A13&#39;, &#39;A14&#39;, &#39;A15&#39;, &#39;A16&#39;, &#39;A17&#39;, &#39;A18&#39;, &#39;A19&#39;, &#39;A20&#39;, &#39;AS1&#39;, &#39;AS2&#39;, &#39;AS3&#39;, &#39;AS4&#39;, &#39;AS5&#39;, &#39;AS6&#39;, &#39;QL4&#39;, &#39;QL5&#39;, &#39;QL6&#39;, &#39;QL7&#39;, &#39;QL8&#39;, &#39;QL9&#39;, &#39;QL10&#39;, &#39;QL11&#39;, &#39;QL12&#39;, &#39;QL13&#39;, &#39;QL14&#39;, &#39;QL15&#39;, &#39;QL16&#39;, &#39;AT1&#39;, &#39;AT2&#39;, &#39;AT7&#39;, &#39;AT9&#39;, &#39;AT10&#39;, &#39;AT11&#39;, &#39;AT12&#39;, &#39;AT13&#39;, &#39;AT14&#39;, &#39;AT17&#39;, &#39;AT18&#39;, &#39;AT19&#39;, &#39;AT20&#39;, &#39;AT21&#39;, &#39;AT22&#39;, &#39;R1&#39;, &#39;R2&#39;, &#39;R3&#39;, &#39;R4&#39;, &#39;R6&#39;, &#39;R8&#39;, &#39;R9&#39;, &#39;R10&#39;, &#39;S1&#39;, &#39;S3&#39;, &#39;AB2&#39;, &#39;SB1&#39;, &#39;RH1&#39;, &#39;RH2&#39;, &#39;RH2-R&#39;, &#39;RH3&#39;, &#39;RH4&#39;, &#39;RH5&#39;, &#39;RH6&#39;, &#39;RH7&#39;, &#39;RH8&#39;, &#39;RH9-R&#39;, &#39;RH10&#39;, &#39;RH11-R&#39;, &#39;RH12&#39;, &#39;RH12-R&#39;, &#39;LP1&#39;, &#39;LP2&#39;, &#39;LP3&#39;, &#39;LP5&#39;, &#39;SG1&#39;, &#39;SG2&#39;, &#39;SG3&#39;, &#39;SG5&#39;, &#39;BC1&#39;, &#39;BC2&#39;, &#39;RR1-R&#39;, &#39;RR1&#39;, &#39;RR3&#39;, &#39;RR4&#39;, &#39;RR4*&#39;, &#39;RR5&#39;, &#39;RR6&#39;, &#39;RR6*&#39;, &#39;RR7-R&#39;, &#39;RR7&#39;, &#39;RR8-R&#39;, &#39;RR9&#39;, &#39;CL1&#39;, &#39;CL2&#39;, &#39;CL3&#39;, &#39;RM1&#39;, &#39;RM2&#39;, &#39;RM3&#39;, &#39;RM4&#39;, &#39;VC1-2&#39;, &#39;VC2&#39;, &#39;VC2-2&#39;, &#39;VC3&#39;, &#39;VC3-2&#39;, &#39;VC5*&#39;, &#39;CP1&#39;]

==&gt;Analyzing pole 1 (Latir_volcanic_field).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>48</td>
      <td>76.3</td>
      <td>185.3</td>
      <td>9.4</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>48</td>
      <td>76.3</td>
      <td>185.3</td>
      <td>9.4</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_339.png" src="_images/0_Preprocessing_19_339.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pass

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           5.4
Critical value of V:  6.4
&quot;Pass&quot;: Since V is less than Vcrit, the null hypothesis
that the two populations are drawn from distributions
that share a common mean direction can not be rejected.

M&amp;M1990 classification:

Angle between data set means: 15.2
Critical angle for M&amp;M1990:   16.5
The McFadden and McElhinny (1990) classification for
this test is: &#39;C&#39;

Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Ambiguous: weak support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_341.png" src="_images/0_Preprocessing_19_341.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Consistent with Fisher distribution
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Pass</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Pass (angle 15.2º below 16.5º critical angle); C classification</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Ambiguous: weak support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Consistent with Fisher distribution</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_345.png" src="_images/0_Preprocessing_19_345.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==&gt;Analyzing pole 2 (Latir_volcanic_field).
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
      <th>Plat</th>
      <th>Plon</th>
      <th>A95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reported mean pole</th>
      <td>43</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from VGPs)</th>
      <td>43</td>
      <td>82.8</td>
      <td>162.6</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>Mean pole (calculated from transformed directions)</th>
      <td>43</td>
      <td>82.8</td>
      <td>162.6</td>
      <td>6.9</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrap reversal test (Tauxe et al., 1991)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_349.png" src="_images/0_Preprocessing_19_349.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fail, distinct in y and z

Parametric reversal test with classification (McFadden and McElhinny, 1990)
------------------------------------------------
Results of Watson V test: 

Watson&#39;s V:           20.3
Critical value of V:  7.0
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 25.0
Critical angle for M&amp;M1990:   14.6


Bayesian reversal test (Heslop &amp; Roberts, 2018)
------------------------------------------------
Different means: very strong support

Fisher distribution Q-Q test (Fisher et al., 1987)
------------------------------------------------
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_351.png" src="_images/0_Preprocessing_19_351.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fisher distribution rejected
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bootstrap reversal test</th>
      <td>Fail</td>
    </tr>
    <tr>
      <th>Parametric reversal test</th>
      <td>Fail (angle 25.0º above 14.6º critical angle)</td>
    </tr>
    <tr>
      <th>Bayesian reversal test</th>
      <td>Different means: very strong support</td>
    </tr>
    <tr>
      <th>Fisher Q-Q test</th>
      <td>Fisher distribution rejected</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/0_Preprocessing_19_355.png" src="_images/0_Preprocessing_19_355.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/indexes/range.py:385,</span> in <span class="ni">RangeIndex.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">    </span><span class="mi">384</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">385</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="ne">ValueError</span>: 31 is not in range

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">Input In [9],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">for</span> <span class="n">file_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_files</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;========================= NEW POLE : </span><span class="si">{</span><span class="n">df_files</span><span class="o">.</span><span class="n">name_xlsx</span><span class="p">[</span><span class="n">file_idx</span><span class="p">]</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">file_idx</span><span class="si">}</span><span class="s1">) =======================&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="n">df_poles</span><span class="p">,</span> <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">split_datasheet</span><span class="p">(</span><span class="n">df_files</span><span class="p">,</span> <span class="n">file_idx</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">df_vgps</span> <span class="o">=</span> <span class="n">recalc_vgps</span><span class="p">(</span><span class="n">df_vgps</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/series.py:958,</span> in <span class="ni">Series.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">955</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">957</span> <span class="k">elif</span> <span class="n">key_is_scalar</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">958</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">960</span> <span class="k">if</span> <span class="n">is_hashable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">961</span>     <span class="c1"># Otherwise index.get_value will raise InvalidIndexError</span>
<span class="g g-Whitespace">    </span><span class="mi">962</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">963</span>         <span class="c1"># For labels that don&#39;t resolve as scalars like tuples and frozensets</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/series.py:1069,</span> in <span class="ni">Series._get_value</span><span class="nt">(self, label, takeable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1066</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1068</span> <span class="c1"># Similar to Index.get_value, but we do not fall back to positional</span>
<span class="ne">-&gt; </span><span class="mi">1069</span> <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1070</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">_get_values_for_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/lib/python3.8/site-packages/pandas/core/indexes/range.py:387,</span> in <span class="ni">RangeIndex.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">    </span><span class="mi">385</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">386</span>     <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">387</span>         <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">388</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_indexing_error</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">389</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: 31
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">studies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dictionary</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Study&#39;</span><span class="p">:</span> <span class="n">studies</span><span class="p">,</span> <span class="s1">&#39;in_study_pole&#39;</span><span class="p">:</span> <span class="n">pps</span><span class="p">,</span> <span class="s1">&#39;Misfit&#39;</span><span class="p">:</span> <span class="n">misfit</span><span class="p">,</span> <span class="s1">&#39;From&#39;</span> <span class="p">:</span> <span class="n">misfit_type</span><span class="p">}</span>
<span class="n">df_misfits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

<span class="n">df_misfits</span> <span class="o">=</span> <span class="n">df_misfits</span><span class="p">[</span><span class="o">~</span><span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;Misfit&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>

<span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;Misfit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;Misfit&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;Misfit&#39;</span><span class="p">],</span> <span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;Misfit&#39;</span><span class="p">])</span>
<span class="n">df_misfits</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Study</th>
      <th>in_study_pole</th>
      <th>Misfit</th>
      <th>From</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Tequila_volcanic_field</td>
      <td>1</td>
      <td>0.034935</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tequila_volcanic_field</td>
      <td>1</td>
      <td>0.379493</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SW_USA_composite</td>
      <td>1</td>
      <td>0.002390</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SW_USA_composite</td>
      <td>1</td>
      <td>0.005706</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>8</th>
      <td>N_Montana_intrusions</td>
      <td>1</td>
      <td>1.169933</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>9</th>
      <td>N_Montana_intrusions</td>
      <td>1</td>
      <td>1.169622</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Central_Mexico_Plio-Pleistocene</td>
      <td>1</td>
      <td>0.344733</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Central_Mexico_Plio-Pleistocene</td>
      <td>1</td>
      <td>0.323528</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Rattlesnake_Hills_volcanics</td>
      <td>1</td>
      <td>0.027504</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Rattlesnake_Hills_volcanics</td>
      <td>1</td>
      <td>0.027504</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Ramsay_Island_lavas</td>
      <td>1</td>
      <td>5.198304</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Ramsay_Island_lavas</td>
      <td>1</td>
      <td>5.198304</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Sierra_de_Las_Cruces</td>
      <td>1</td>
      <td>1.134276</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Sierra_de_Las_Cruces</td>
      <td>1</td>
      <td>1.134276</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Snake_River_Plain</td>
      <td>1</td>
      <td>0.025825</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Snake_River_Plain</td>
      <td>1</td>
      <td>0.025825</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Sonoma_volcanics</td>
      <td>1</td>
      <td>0.131832</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Sonoma_volcanics</td>
      <td>1</td>
      <td>0.137908</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Mistastin_Lake_impact</td>
      <td>1</td>
      <td>0.259412</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Mistastin_Lake_impact</td>
      <td>1</td>
      <td>0.259412</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Absaroka_volcanics</td>
      <td>1</td>
      <td>0.196181</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Absaroka_volcanics</td>
      <td>1</td>
      <td>0.196430</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Absaroka_volcanics</td>
      <td>3</td>
      <td>0.132521</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Absaroka_volcanics</td>
      <td>3</td>
      <td>0.110828</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Eastern_TMVB</td>
      <td>1</td>
      <td>1.323173</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Eastern_TMVB</td>
      <td>1</td>
      <td>1.323173</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Eastern_TMVB</td>
      <td>2</td>
      <td>1.389618</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Eastern_TMVB</td>
      <td>2</td>
      <td>1.389618</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Eastern_TMVB</td>
      <td>3</td>
      <td>0.809443</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Eastern_TMVB</td>
      <td>3</td>
      <td>0.809443</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Western_Central_TMVB</td>
      <td>1</td>
      <td>0.038436</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Western_Central_TMVB</td>
      <td>1</td>
      <td>0.039508</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Western_Central_TMVB</td>
      <td>2</td>
      <td>0.216719</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Western_Central_TMVB</td>
      <td>2</td>
      <td>0.210800</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Dinan_Bay_lavas</td>
      <td>1</td>
      <td>0.753719</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Dinan_Bay_lavas</td>
      <td>1</td>
      <td>0.753719</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Michoacan_Guanajuato_volcanic_field</td>
      <td>1</td>
      <td>1.338717</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Michoacan_Guanajuato_volcanic_field</td>
      <td>1</td>
      <td>1.338717</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>62</th>
      <td>San_Luis_Hills_volcanics</td>
      <td>1</td>
      <td>1.225500</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>63</th>
      <td>San_Luis_Hills_volcanics</td>
      <td>1</td>
      <td>1.225345</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Beaver_River_intrusions</td>
      <td>1</td>
      <td>0.366473</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Beaver_River_intrusions</td>
      <td>1</td>
      <td>0.366473</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Mariscal_Mtn_intrusions</td>
      <td>1</td>
      <td>0.025776</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Mariscal_Mtn_intrusions</td>
      <td>1</td>
      <td>0.031500</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Mogollon-Datil_volcanics</td>
      <td>1</td>
      <td>0.092155</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Mogollon-Datil_volcanics</td>
      <td>1</td>
      <td>0.059457</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Mogollon-Datil_volcanics</td>
      <td>2</td>
      <td>3.323328</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Mogollon-Datil_volcanics</td>
      <td>2</td>
      <td>2.187932</td>
      <td>recalculated</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Monterey_intrusions</td>
      <td>2</td>
      <td>2.129359</td>
      <td>reported</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Monterey_intrusions</td>
      <td>2</td>
      <td>2.129359</td>
      <td>recalculated</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">)})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Study&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;Misfit&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;in_study_pole&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_misfits</span><span class="p">[</span><span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;reported&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Angular distance between reported paleopole and pole calculated from reported VGPs&quot;</span><span class="p">)</span>
<span class="c1">#ax.xaxis.get_label().set_fontsize(20)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 1.0, &#39;Angular distance between reported paleopole and pole calculated from reported VGPs&#39;)]
</pre></div>
</div>
<img alt="_images/0_Preprocessing_22_1.png" src="_images/0_Preprocessing_22_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">)})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Study&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;Misfit&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;in_study_pole&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_misfits</span><span class="p">[</span><span class="n">df_misfits</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;recalculated&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Angular distance between reported paleopole and pole calculated from recalculated VGPs&quot;</span><span class="p">)</span>
<span class="c1">#ax.xaxis.get_label().set_fontsize(20)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(0.5, 1.0, &#39;Angular distance between reported paleopole and pole calculated from recalculated VGPs&#39;)]
</pre></div>
</div>
<img alt="_images/0_Preprocessing_23_1.png" src="_images/0_Preprocessing_23_1.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Young CEED Team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>